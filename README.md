# csvConverter
3rd individual work

## Программа написана на PHP и предназначена что бы преобразовать данные из csv-файла, в которых значения определенных полей заменяется по конфигурационному файлу

### Что бы использовать консольную программу, на рабочей машине нужно установить следующее ПО

+ PHP 7 
+ Composer

### Для разворачивания проекта необходимо выполнить следующие команды:

+ git clone https://github.com/Roman0532/CVSconverter.git

+ cd csvConverter
  
+ composer install

### Пример входного файла

  100,"Советский 2/7, кв. 23","Иванов Иван Иванович",23 
  
  101,"Советский 2/6, кв. 26","Петров Иван Иванович",35
  
  102,"Карболитовская 1, кв. 24","Сидоров Иван Иванович",45

### Пример конфигурационного файла
```php
<?php

return [
        1 => 'streetName', // faker
        2 => null, // set value to null
        3 => function ($value, $rowData, $rowIndex, $faker) {
            if ($value == 23) {
                return $rowIndex + 5;
            }
            if ($rowData[0] == 101) {
                return 0;
            }
            return $faker->randomDigit;
    	},
];
```
Конфигурация задается на языке php и кроме типов из Faker, можно указать функцию, которая возвращает точное значение для этого поля. Аргументы функции: 1) текущее значение, 2) массив значений текущей строки, 3) номер строки данных, 4) экземпляр $faker.

### Для запуска программы необходимо в консоли ввести команду php index.php [options];

#### Cуществуют следующие [options] :
  
- -i|--input file - путь до исходного файла
  
- -c|--config file - путь до файла конфигурации

- -o|--output file - путь до файла с результатом

- -d|--delimiter delim - задать разделитель (по умолчанию “,”)

- --skip-first - пропускать модификацию первой строки исходного csv

- --strict - проверять, что исходный файл содержит необходимое количество описанных в конфигурационном файле столбцов. При несоответствии выдавать ошибку.

-  -h|--help - вывести справку
 

### Для запуска unit тестов необходимо

+  cd ./tests/
+  Выполнить команду phpunit .
